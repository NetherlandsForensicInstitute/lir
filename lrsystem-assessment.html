

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assessing LR system performance &mdash; LiR - Likelihood Ratio Toolkit  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
      <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
      <script src="_static/thebelab-helper.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Registry reference" href="reference.html" />
    <link rel="prev" title="Overview of the Python API" href="api-overview.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            LiR - Likelihood Ratio Toolkit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="guides.html">Guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="lrsystem_yaml.html">LR System selection helper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lrsystem_yaml.html#specific-source-system">Specific source system</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrsystem_yaml.html#pre-scored-common-source-system">Pre-scored common source system</a></li>
<li class="toctree-l3"><a class="reference internal" href="lrsystem_yaml.html#common-source-system">Common source system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api-overview.html">Overview of the Python API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api-overview.html#data-classes">Data classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-overview.html#data-strategies">Data strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-overview.html#lr-systems">LR systems</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Assessing LR system performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#metrics">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizations">Visualizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#neutral-llrs">Neutral LLRs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#well-calibrated-llrs">Well-calibrated LLRs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#badly-calibrated-data">Badly calibrated data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">Registry reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reference.html#experiment-components">Experiment components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference.html#experiment-strategies">Experiment strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#data-strategies">Data strategies</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#data-providers">Data providers</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#metrics">Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#hyperparameters">Hyperparameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="reference.html#lr-system-components">LR system components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="reference.html#lr-system-architecture">LR system architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#lr-system-modules">LR system modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="reference.html#pairing-methods">Pairing methods</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/lir/lir.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lir</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/lir/lir.html#subpackages">Subpackages</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/lir/lir.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="api/lir/lir.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LiR - Likelihood Ratio Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="guides.html">Guides</a></li>
      <li class="breadcrumb-item active">Assessing LR system performance</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/lrsystem-assessment.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="assessing-lr-system-performance">
<h1>Assessing LR system performance<a class="headerlink" href="#assessing-lr-system-performance" title="Link to this heading"></a></h1>
<p>This page shows how LiR can be used to assess the <a class="reference external" href="https://doi.org/10.1016/j.forsciint.2016.03.048">performance</a> of an LR system, in particular discriminatory power
and <a class="reference external" href="https://doi.org/10.1016/j.forsciint.2021.110722">consistency</a>. These metrics are typically used to judge whether an LR system is good enough for use in casework,
or to find the best LR system among several candidates.</p>
<p><strong>Note:</strong> in literature, the term ‘calibration’ is sometimes used to refer to whether an LR system is ‘well-calibrated’
or ‘consistent’. Here, we reserve <cite>calibration</cite> for the process, while we use ‘consistency’ for the quality of the LLRs.</p>
<section id="metrics">
<h2>Metrics<a class="headerlink" href="#metrics" title="Link to this heading"></a></h2>
<p>A <a class="reference external" href="https://doi.org/10.1016/j.fsisyn.2024.100466">widely used</a> metric of performance is Cllr, which measures both discrimination and consistency.
Other metrics may have practical use as well. See the table below for a list of metrics.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Metric</p></th>
<th class="head"><p>Assessment of</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>log likelihood ratio cost (<a class="reference external" href="api/lir.metrics.html#lir.metrics.cllr">cllr</a>)</p></td>
<td><p>discrimination and consistency</p></td>
</tr>
<tr class="row-odd"><td><p>minimized cllr (<a class="reference external" href="api/lir.metrics.html#lir.metrics.cllr_min">cllr_min</a>)</p></td>
<td><p>discrimination</p></td>
</tr>
<tr class="row-even"><td><p>calibration loss (<a class="reference external" href="api/lir.metrics.html#lir.metrics.cllr_cal">cllr_cal</a>)</p></td>
<td><p>consistency</p></td>
</tr>
<tr class="row-odd"><td><p>rate of misleading evidence</p></td>
<td><p>mostly consistency</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="api/lir.metrics.html#lir.metrics.devpav.devpav">devPAV</a></p></td>
<td><p>consistency</p></td>
</tr>
<tr class="row-odd"><td><p>expected LR for both hypotheses</p></td>
<td><p>discrimination</p></td>
</tr>
</tbody>
</table>
<p>By definition, the log likelihood ratio cost <code class="docutils literal notranslate"><span class="pre">cllr</span></code> equals <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> + <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code>.</p>
</section>
<section id="visualizations">
<h2>Visualizations<a class="headerlink" href="#visualizations" title="Link to this heading"></a></h2>
<p>While a one-dimensional metric is often useful, visualizations give more insight in the behavior of the LR system.
Examples of visualizations are:</p>
<ul class="simple">
<li><p><a class="reference external" href="api/lir.plotting.html#lir.plotting.lr_histogram">LR histogram</a>, for assessment of discrimination</p></li>
<li><p>Pool adjacent violators (<a class="reference external" href="api/lir.plotting.html#lir.plotting.pav">PAV</a>) transformation, for assessment of consistency</p></li>
<li><p>Empirical cross-entropy (<a class="reference external" href="api/lir.plotting.html#lir.plotting.expected_calibration_error.plot_ece">ECE</a>)</p></li>
<li><p><a class="reference external" href="api/lir.plotting.html#lir.plotting.tippett">Tippett</a></p></li>
</ul>
<p>Let’s see how these metrics and visualizations behave on different types of data.</p>
</section>
<section id="neutral-llrs">
<h2>Neutral LLRs<a class="headerlink" href="#neutral-llrs" title="Link to this heading"></a></h2>
<p>First, non-informative data, where all LLRs are zero (i.e. neutral). These data are not discriminative, but perfectly
consistent!</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.data.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">LLRData</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">cllr</span><span class="p">,</span> <span class="n">cllr_min</span><span class="p">,</span> <span class="n">cllr_cal</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.metrics.devpav</span><span class="w"> </span><span class="kn">import</span> <span class="n">devpav</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">lr_histogram</span><span class="p">,</span> <span class="n">pav</span><span class="p">,</span> <span class="n">tippett</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.plotting.expected_calibration_error</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_ece</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">llrs</span><span class="p">:</span> <span class="n">LLRData</span><span class="p">):</span>
    <span class="c1"># print the metrics</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cllr: </span><span class="si">{</span><span class="n">cllr</span><span class="p">(</span><span class="n">llrs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cllr_min: </span><span class="si">{</span><span class="n">cllr_min</span><span class="p">(</span><span class="n">llrs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;cllr_cal: </span><span class="si">{</span><span class="n">cllr_cal</span><span class="p">(</span><span class="n">llrs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;devpav: </span><span class="si">{</span><span class="n">devpav</span><span class="p">(</span><span class="n">llrs</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># initialize the plot</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_lrhist</span><span class="p">,</span> <span class="n">ax_pav</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_ece</span><span class="p">,</span> <span class="n">ax_tippett</span><span class="p">))</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># create the visualizations</span>
    <span class="n">lr_histogram</span><span class="p">(</span><span class="n">ax_lrhist</span><span class="p">,</span> <span class="n">llrs</span><span class="p">)</span>
    <span class="n">pav</span><span class="p">(</span><span class="n">ax_pav</span><span class="p">,</span> <span class="n">llrs</span><span class="p">)</span>
    <span class="n">plot_ece</span><span class="p">(</span><span class="n">ax_ece</span><span class="p">,</span> <span class="n">llrs</span><span class="p">)</span>
    <span class="n">tippett</span><span class="p">(</span><span class="n">ax_tippett</span><span class="p">,</span> <span class="n">llrs</span><span class="p">)</span>

    <span class="c1"># generate the image</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># generate neutral LLRs</span>
<span class="n">llrs</span> <span class="o">=</span> <span class="n">LLRData</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">labels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>

<span class="c1"># show results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;results for neutral (non-informative) LLR values&#39;</span><span class="p">)</span>
<span class="n">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">llrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>results for neutral (non-informative) LLR values
cllr: 1.0
cllr_min: 1.0
cllr_cal: 0.0
devpav: 0.0
</pre></div>
</div>
<img alt="_images/lrsystem-assessment_0_1.png" src="_images/lrsystem-assessment_0_1.png" />
</div>
</div>
<p>Observe that:</p>
<ul class="simple">
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr</span></code> is 1;</p></li>
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> is 1;</p></li>
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code> is 0;</p></li>
<li><p>the LR histogram shows a single bar;</p></li>
<li><p>in the ECE plot, the LRs line, the reference line and the PAV LRs line are the equivalent;</p></li>
<li><p>the PAV plot and the Tippett plot hardly make sense if all LLRs have the same value.</p></li>
</ul>
</section>
<section id="well-calibrated-llrs">
<h2>Well-calibrated LLRs<a class="headerlink" href="#well-calibrated-llrs" title="Link to this heading"></a></h2>
<p>Now, we have LLRs that are both discriminative and consistent, and data of both hypotheses are drawn from a normal
distribution. It visualizes as follows.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">lir.algorithms.logistic_regression</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogitCalibrator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.data.data_strategies</span><span class="w"> </span><span class="kn">import</span> <span class="n">BinaryTrainTestSplit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">lir.data.datasets.synthesized_normal_binary</span><span class="w"> </span><span class="kn">import</span> <span class="n">SynthesizedNormalData</span><span class="p">,</span> <span class="n">SynthesizedNormalBinaryData</span>

<span class="c1"># set the parameters for H1 data and H2 data</span>
<span class="n">h1_data</span> <span class="o">=</span> <span class="n">SynthesizedNormalData</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">h2_data</span> <span class="o">=</span> <span class="n">SynthesizedNormalData</span><span class="p">(</span><span class="n">mean</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># generate the data</span>
<span class="n">instances</span> <span class="o">=</span> <span class="n">SynthesizedNormalBinaryData</span><span class="p">(</span><span class="n">h1_data</span><span class="p">,</span> <span class="n">h2_data</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span><span class="o">.</span><span class="n">get_instances</span><span class="p">()</span>

<span class="c1"># split the data into a 50% training set and a 50% test set</span>
<span class="n">training_instances</span><span class="p">,</span> <span class="n">test_instances</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">BinaryTrainTestSplit</span><span class="p">(</span><span class="n">test_size</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">instances</span><span class="p">))</span>

<span class="c1"># build a simple LR system for these data</span>
<span class="n">calibrator</span> <span class="o">=</span> <span class="n">LogitCalibrator</span><span class="p">()</span>

<span class="c1"># train the system on the training set, and calculate the LLRs for the test set</span>
<span class="n">llrs</span> <span class="o">=</span> <span class="n">calibrator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_instances</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">test_instances</span><span class="p">)</span>

<span class="c1"># assess performance</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;results for well-calibrated LLR values&#39;</span><span class="p">)</span>
<span class="n">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">llrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>results for well-calibrated LLR values
cllr: 0.49710979600293703
cllr_min: 0.47110247206061767
cllr_cal: 0.02600732394231936
devpav: 0.16984985956316723
</pre></div>
</div>
<img alt="_images/lrsystem-assessment_1_1.png" src="_images/lrsystem-assessment_1_1.png" />
</div>
</div>
<p>Observe that, for discriminative and well-calibrated LLRs:</p>
<ul class="simple">
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr</span></code> is lower than 1;</p></li>
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> is close to <code class="docutils literal notranslate"><span class="pre">cllr</span></code>;</p></li>
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code> is close to 0;</p></li>
<li><p>the LR histogram shows distinct distributions;</p></li>
<li><p>in the LR histogram, the peak of the overlap of both distributions is at 0;</p></li>
<li><p>the PAV plot approximately follows the diagonal;</p></li>
<li><p>in the ECE plot, the LRs line is close to the PAV-LRs line, and the reference line is wel above both of them.</p></li>
</ul>
</section>
<section id="badly-calibrated-data">
<h2>Badly calibrated data<a class="headerlink" href="#badly-calibrated-data" title="Link to this heading"></a></h2>
<p>LR systems may misbehave in several ways, resulting in inconsistent LLRs.
If this happens, check if the the training data is suitable for the test data. Inconsistent LLRs can be caused, for
example, when the training data are measurements of a different type of glass, when training data are from voice
recordings of a microphone versus telephone interception in the test data, or any other kind of mismatch between the
training set and the test set.</p>
<p>LLRs may be inconsistent in several ways, including:</p>
<ul class="simple">
<li><p>bias towards H1, meaning that the LLRs are too big;</p></li>
<li><p>bias towards H2, meaning that the LLRs are too small;</p></li>
<li><p>overestimation, meaning that the LLRs are too extreme;</p></li>
<li><p>underestimation, meaning that the LLRs are too close to 0.</p></li>
</ul>
<p>Below are the results of each of such inconsistent sets of LLRs.
Let’s have a look at the metrics and visualizations for each of those.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;all LLR values are *shifted* towards H1&#39;</span><span class="p">)</span>
<span class="n">biased_llrs_towards_h1</span> <span class="o">=</span> <span class="n">llrs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">llrs</span><span class="o">.</span><span class="n">features</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">biased_llrs_towards_h1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>all LLR values are *shifted* towards H1
cllr: 2.0247525542328266
cllr_min: 0.47110247206061767
cllr_cal: 1.553650082172209
devpav: 1.9046812146931815
</pre></div>
</div>
<img alt="_images/lrsystem-assessment_2_1.png" src="_images/lrsystem-assessment_2_1.png" />
</div>
</div>
<p>Observations for LLRs that are biased towards H1:</p>
<ul class="simple">
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr</span></code> is increased from well-calibrated data;</p></li>
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> is the same as in well-calibrated data;</p></li>
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code> is greater than 0;</p></li>
<li><p>the LR histogram still shows distinct distributions, but they are shifted to the <strong>right</strong>;</p></li>
<li><p>in the LR histogram, the peak of the overlap of both distributions is to the right of 0;</p></li>
<li><p>the PAV plot is <strong>below</strong> the diagonal;</p></li>
<li><p>in the ECE plot, the LRs line is evidently above the PAV-LRs line and closer to the reference line (if the LLRs are
wildly biased, the LRs line may even be partially above the reference line);</p></li>
<li><p>the Tippett plot is shifted to the left.</p></li>
</ul>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;all LLR values are *shifted* towards H2&#39;</span><span class="p">)</span>
<span class="n">biased_llrs_towards_h2</span> <span class="o">=</span> <span class="n">llrs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">llrs</span><span class="o">.</span><span class="n">features</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">biased_llrs_towards_h2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>all LLR values are *shifted* towards H2
cllr: 2.0372726627997064
cllr_min: 0.47110247206061767
cllr_cal: 1.5661701907390888
devpav: 2.095318785306818
</pre></div>
</div>
<img alt="_images/lrsystem-assessment_3_1.png" src="_images/lrsystem-assessment_3_1.png" />
</div>
</div>
<p>Observations for LLRs that are biased towards H2:</p>
<ul class="simple">
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr</span></code>, <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> and <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code> are similar to data biased towards H1;</p></li>
<li><p>the LR histogram still shows distinct distributions, but they are shifted to the <strong>left</strong>;</p></li>
<li><p>in the LR histogram, the peak of the overlap of both distributions is to the right of 0;</p></li>
<li><p>the PAV plot is <strong>above</strong> the diagonal;</p></li>
<li><p>in the ECE plot, the LRs line is evidently above the PAV-LRs line, similar to the LLRs shifted towards H1;</p></li>
<li><p>the Tippett plot is shifted to the right.</p></li>
</ul>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the LLRs are *increased* towards the extremes on both sides&#39;</span><span class="p">)</span>
<span class="n">overestimated_llrs</span> <span class="o">=</span> <span class="n">llrs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">llrs</span><span class="o">.</span><span class="n">features</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">overestimated_llrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>the LLRs are *increased* towards the extremes on both sides
cllr: 0.5951664693105603
cllr_min: 0.47110247206061767
cllr_cal: 0.1240639972499426
devpav: 0.9477891342844413
</pre></div>
</div>
<img alt="_images/lrsystem-assessment_4_1.png" src="_images/lrsystem-assessment_4_1.png" />
</div>
</div>
<p>Observations for overestimated LLRs:</p>
<ul class="simple">
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr</span></code>, <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> and <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code> are similar to biased data;</p></li>
<li><p>the LR histogram still shows distinct distributions, but the scale on the X-axis is increased;</p></li>
<li><p>the PAV plot is flatter than the diagonal, and crosses it near the origin;</p></li>
<li><p>in the ECE plot, the LRs line is slightly further away from the PAV-LRs line, and may cross the reference line near
the extremes;</p></li>
<li><p>the scale of the Tippett plot is increased.</p></li>
</ul>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the LLRs are *reduced* towards neutrality&#39;</span><span class="p">)</span>
<span class="n">underestimated_llrs</span> <span class="o">=</span> <span class="n">llrs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">llrs</span><span class="o">.</span><span class="n">features</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">llr_metrics_and_visualizations</span><span class="p">(</span><span class="n">underestimated_llrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>the LLRs are *reduced* towards neutrality
cllr: 0.5763525530521564
cllr_min: 0.47110247206061767
cllr_cal: 0.10525008099153871
devpav: 0.5584182072909141
</pre></div>
</div>
<img alt="_images/lrsystem-assessment_5_1.png" src="_images/lrsystem-assessment_5_1.png" />
</div>
</div>
<p>Observations for overestimated LLRs:</p>
<ul class="simple">
<li><p>the value for <code class="docutils literal notranslate"><span class="pre">cllr</span></code>, <code class="docutils literal notranslate"><span class="pre">cllr_min</span></code> and <code class="docutils literal notranslate"><span class="pre">cllr_cal</span></code> are similar to biased data;</p></li>
<li><p>the LR histogram still shows distinct distributions, but the scale on the X-axis is increased;</p></li>
<li><p>the PAV plot is steeper than the diagonal, and crosses it near the origin;</p></li>
<li><p>in the ECE plot, the LRs line is slightly further away from the PAV-LRs line;</p></li>
<li><p>the scale of the Tippett plot is decreased.</p></li>
</ul>
<p>That’s all for now!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="api-overview.html" class="btn btn-neutral float-left" title="Overview of the Python API" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reference.html" class="btn btn-neutral float-right" title="Registry reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Netherlands Forensic Institute.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>